{% extends 'base.html' %}
{% block content %}
    <h2>Inbox</h2>
    <div class="card">
        <div class="card-body">
            {% if conversations %}
                <ul class="list-group">
                    {% for conv in conversations %}
                        <li class="list-group-item d-flex justify-content-between align-items-center">
                            <div>
                                <a href="{% if conv.ad %}{% url 'conversation' conv.user.id conv.ad.id %}{% else %}{% url 'conversation' conv.user.id %}{% endif %}">
                                    <strong>{{ conv.user.username }}</strong> 
                                    {% if conv.ad %}re: {{ conv.ad.title }}{% endif %}
                                    <p class="mb-0">{{ conv.last_message.content|truncatewords:10 }}</p>
                                    <small class="text-muted">{{ conv.last_message.created_at|date:"M d, Y H:i" }}</small>
                                </a>
                            </div>
                            {% if conv.unread_count > 0 %}
                                <span class="badge bg-primary rounded-pill">{{ conv.unread_count }}</span>
                            {% endif %}
                        </li>
                    {% endfor %}
                </ul>
            {% else %}
                <p>No conversations yet.</p>
            {% endif %}
        </div>
    </div>
{% endblock %}